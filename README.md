# FaceAnalysis-API

**FaceAnalysis-API** ‚Äî —Ü–µ Python-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –æ–±–ª–∏—á –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö —Ç–∞ –≤—ñ–¥–µ–æ, –∑—Ä—É—á–Ω–æ–≥–æ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è HTML-–∑–≤—ñ—Ç—ñ–≤, –∞ —Ç–∞–∫–æ–∂ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤. –ü—Ä–æ—î–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—É—á–∞—Å–Ω—ñ AI-–º–æ–¥–µ–ª—ñ (InsightFace, OpenVINO), –º–∞—î REST API —Ç–∞ –º–æ–¥—É–ª—å–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –≥–Ω—É—á–∫–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

---

## –û—Å–Ω–æ–≤–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

- **–î–µ—Ç–µ–∫—Ü—ñ—è —Ç–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –æ–±–ª–∏—á** –Ω–∞ —Ñ–æ—Ç–æ —Ç–∞ –≤—ñ–¥–µ–æ
- **–í–∏—Ç—è–≥ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤** (—Å—Ç–∞—Ç—å, –≤—ñ–∫, –µ–º–æ—Ü—ñ—ó) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –æ–±–ª–∏—á—á—è
- **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è HTML-–∑–≤—ñ—Ç—ñ–≤** –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª—ñ–∑—É
- **REST API** –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (FastAPI/Flask)
- **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å—ñ–≤** (CPU, RAM) –≤ –ø—Ä–æ—Ü–µ—Å—ñ –∞–Ω–∞–ª—ñ–∑—É
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –º–æ–¥–µ–ª–µ–π —É —Ñ–æ—Ä–º–∞—Ç–∞—Ö Intel/OpenVINO —Ç–∞ ONNX

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ analysis.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ resource_logging.py
‚îÇ   ‚îî‚îÄ‚îÄ video_processing.py
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ frames/
‚îÇ   ‚îî‚îÄ‚îÄ video.mp4
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ intel/
‚îÇ   ‚îî‚îÄ‚îÄ onnx/
‚îú‚îÄ‚îÄ photo/         # –í—Ö—ñ–¥–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
‚îú‚îÄ‚îÄ report/
‚îÇ   ‚îú‚îÄ‚îÄ html_report.py
‚îÇ   ‚îú‚îÄ‚îÄ report.html
‚îÇ   ‚îú‚îÄ‚îÄ video_report.html
‚îÇ   ‚îú‚îÄ‚îÄ report-body.html
‚îÇ   ‚îî‚îÄ‚îÄ report.css
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ resource_log.txt
‚îî‚îÄ‚îÄ venv/          # –í—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –æ—Ç–æ—á–µ–Ω–Ω—è (—ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ—ó)
```

---

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π**
   ```bash
   git clone https://github.com/vladyslav0chornyi/FaceAnalysis-API.git
   cd FaceAnalysis-API
   ```

2. **–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –æ—Ç–æ—á–µ–Ω–Ω—è**
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ**
   ```bash
   pip install --upgrade pip
   pip install -r requirements.txt
   ```

   > **–î–æ–¥–∞—Ç–∫–æ–≤–æ:** –î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ OpenVINO –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ [OpenVINO‚Ñ¢ Toolkit](https://docs.openvino.ai/latest/openvino_docs_install_guides_installing_openvino_linux.html).

---

## –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

1. **–ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª—ñ–∑—É**
   ```bash
   python3 main.py
   ```
   –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º API —Å—Ç–∞—Ä—Ç—É—î –Ω–∞ [http://localhost:8000](http://localhost:8000)

2. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API (FastAPI Swagger UI)**
   - –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É –±—Ä–∞—É–∑–µ—Ä—ñ: [http://localhost:8000/docs](http://localhost:8000/docs)
   - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `/analyze-photo`, `/analyze-video`.

3. **–ê–Ω–∞–ª—ñ–∑ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ curl:**
   ```bash
   curl -X POST "http://localhost:8000/analyze-photo" -F "file=@photo/photo.jpg"
   ```

4. **–†–µ–∑—É–ª—å—Ç–∞—Ç–∏**
   - –ö–∞–¥—Ä–∏ –∑ –≤—ñ–¥–µ–æ: `data/frames/`
   - HTML-–∑–≤—ñ—Ç–∏: `report/report.html`, `report/video_report.html`
   - –õ–æ–≥–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤: `resource_log.txt`

---

## –ü—Ä–∏–∫–ª–∞–¥ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

### –ê–Ω–∞–ª—ñ–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó

1. –î–æ–¥–∞—î—à —Ñ–æ—Ç–æ —É –ø–∞–ø–∫—É `photo/`
2. –í–∏–∫–ª–∏–∫–∞—î—à –µ–Ω–¥–ø–æ—ñ–Ω—Ç –∞–±–æ –∑–∞–ø—É—Å–∫–∞—î—à —Å–∫—Ä–∏–ø—Ç
3. –û—Ç—Ä–∏–º—É—î—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –≤–∏–≥–ª—è–¥—ñ HTML-–∑–≤—ñ—Ç—É —É `report/`

### –ê–Ω–∞–ª—ñ–∑ –≤—ñ–¥–µ–æ

1. –ö–ª–∞–¥–µ—à –≤—ñ–¥–µ–æ—Ñ–∞–π–ª —É `data/video.mp4`
2. –ó–∞–ø—É—Å–∫–∞—î—à –æ–±—Ä–æ–±–∫—É —á–µ—Ä–µ–∑ API –∞–±–æ –Ω–∞–ø—Ä—è–º—É —á–µ—Ä–µ–∑ `core/video_processing.py`
3. –ö–∞–¥—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É `data/frames/`, –∞ –∑–≤—ñ—Ç ‚Äî —É `report/video_report.html`

---

## –û—Å–Ω–æ–≤–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- Python 3.9+
- [FastAPI](https://fastapi.tiangolo.com/) –∞–±–æ [Flask](https://flask.palletsprojects.com/)
- [InsightFace](https://github.com/deepinsight/insightface)
- [OpenVINO](https://github.com/openvinotoolkit/openvino)
- opencv-python
- numpy
- psutil
- Jinja2

**–ü–æ–≤–Ω–∏–π –ø–µ—Ä–µ–ª—ñ–∫ ‚Äî —É [requirements.txt](requirements.txt)**

---

## Advanced AI models

FaceAnalysis-API –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å—É—á–∞—Å–Ω—ñ –º–æ–¥–µ–ª—ñ –º–∞—à–∏–Ω–Ω–æ–≥–æ –∑–æ—Ä—É –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å –∞–Ω–∞–ª—ñ–∑—É –æ–±–ª–∏—á. –£—Å—ñ –º–æ–¥–µ–ª—ñ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ.

### üî¨ InsightFace Models
- **ArcFace**: –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –æ–±–ª–∏—á –∑ –≤–∏—Å–æ–∫–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é
- **RetinaFace**: –ù–∞–¥—ñ–π–Ω–∞ –¥–µ—Ç–µ–∫—Ü—ñ—è –æ–±–ª–∏—á
- **GenderAge**: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—Ç—ñ —Ç–∞ –≤—ñ–∫—É
- **Mask Detection**: –î–µ—Ç–µ–∫—Ü—ñ—è –º–µ–¥–∏—á–Ω–∏—Ö –º–∞—Å–æ–∫

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π:**
```bash
cd models/insightface/
# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–¥–µ–ª—ñ (–¥–∏–≤. README —É –ø–∞–ø—Ü—ñ)
wget -O arcface_r100_v1.onnx https://github.com/deepinsight/insightface/releases/download/v0.7/arcface_r100_v1.onnx
```
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: [models/insightface/README.md](models/insightface/README.md)

### üé≠ BiSeNet (Face Parsing)
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –°–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—è —á–∞—Å—Ç–∏–Ω –æ–±–ª–∏—á—á—è (—à–∫—ñ—Ä–∞, –≤–æ–ª–æ—Å—Å—è, –æ—á—ñ, –Ω—ñ—Å, —Ä–æ—Ç)
- **–§–æ—Ä–º–∞—Ç**: PyTorch (.pth), ONNX

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π:**
```bash
cd models/bisenet/
wget -O bisenet_v2_face_parsing.pth https://github.com/zllrunning/face-parsing.PyTorch/releases/download/v1.0/79999_iter.pth
```
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: [models/bisenet/README.md](models/bisenet/README.md)

### üï∏Ô∏è MediaPipe
- **FaceMesh**: 3D –ª–µ–Ω–¥–º–∞—Ä–∫–∏ –æ–±–ª–∏—á—á—è (468 —Ç–æ—á–æ–∫)
- **Face Detection**: –®–≤–∏–¥–∫–∞ –¥–µ—Ç–µ–∫—Ü—ñ—è –æ–±–ª–∏—á
- **Face Landmarks**: 2D –ª–µ–Ω–¥–º–∞—Ä–∫–∏ (68 –∫–ª—é—á–æ–≤–∏—Ö —Ç–æ—á–æ–∫)

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:**
```bash
# –ú–æ–¥–µ–ª—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ MediaPipe
pip install mediapipe
```
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: [models/mediapipe/README.md](models/mediapipe/README.md)

### üß† DeepFace (Multi-Modal)
- **Emotion Recognition**: 7 –±–∞–∑–æ–≤–∏—Ö –µ–º–æ—Ü—ñ–π
- **Age Estimation**: –û—Ü—ñ–Ω–∫–∞ –≤—ñ–∫—É (0-100 —Ä–æ–∫—ñ–≤)
- **Gender Classification**: –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞—Ç—ñ
- **Race Detection**: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ç–Ω—ñ—á–Ω–æ—ó –ø—Ä–∏–Ω–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:**
```bash
# –ú–æ–¥–µ–ª—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ DeepFace
pip install deepface
```
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: [models/deepface/README.md](models/deepface/README.md)

### üìã –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –∑ –Ω–æ–≤–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏

1. **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:**
   ```bash
   pip install -r requirements.txt
   ```

2. **–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –º–æ–¥–µ–ª—ñ:**
   ```bash
   # –¢—ñ–ª—å–∫–∏ –¥–ª—è InsightFace —Ç–∞ BiSeNet (—ñ–Ω—à—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
   bash scripts/download_models.sh  # (—Å—Ç–≤–æ—Ä—ñ—Ç—å —Ü–µ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ)
   ```

3. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ –∫–æ–¥:**
   ```python
   # –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è (–¥–∏–≤. –ø–æ–≤–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤ README –∫–æ–∂–Ω–æ—ó –º–æ–¥–µ–ª—ñ)
   from insightface.app import FaceAnalysis
   from deepface import DeepFace
   import mediapipe as mp
   
   # InsightFace
   app = FaceAnalysis()
   app.prepare(ctx_id=0)
   
   # DeepFace (–≤–∂–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ –≤ –ø—Ä–æ–µ–∫—Ç)
   result = DeepFace.analyze(img, actions=['emotion', 'age', 'gender'])
   
   # MediaPipe
   mp_face_mesh = mp.solutions.face_mesh
   ```

**‚ö†Ô∏è –ü—Ä–∏–º—ñ—Ç–∫–∞**: –§–∞–π–ª–∏ –º–æ–¥–µ–ª–µ–π –Ω–µ –≤–∫–ª—é—á–µ–Ω—ñ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π. –ó–∞–≤–∞–Ω—Ç–∞–∂—É–π—Ç–µ —ó—Ö –æ–∫—Ä–µ–º–æ –∑–≥—ñ–¥–Ω–æ –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –≤ README –∫–æ–∂–Ω–æ—ó –ø–∞–ø–∫–∏.

---

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å—ñ–≤

- **resource_log.txt** –º—ñ—Å—Ç–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ (CPU, RAM) –ø—ñ–¥ —á–∞—Å –∞–Ω–∞–ª—ñ–∑—É.

---

## –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –≤–Ω–µ—Å–æ–∫

- –í—Å—ñ pull-requests —Ç–∞ issue –≤—ñ—Ç–∞—é—Ç—å—Å—è!
- –î–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É –¥–æ–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ñ –º–æ–¥—É–ª—ñ —É –ø–∞–ø–∫–∏ `core/` –∞–±–æ `report/`
- –ü–∏—Ç–∞–Ω–Ω—è ‚Äî —É [issues](https://github.com/vladyslav0chornyi/FaceAnalysis-API/issues)

---

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT (–∞–±–æ –¥–æ–¥–∞–π—Ç–µ —Å–≤–æ—é)

---

**–ê–≤—Ç–æ—Ä**: [vladyslav0chornyi](https://github.com/vladyslav0chornyi)